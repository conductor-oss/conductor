<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  <link rel="shortcut icon" href="../img/favicon.ico">
  <title>Conductor Server - Conductor</title>
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
  <link href="../css/custom.css" rel="stylesheet">
  
  <script>
    // Current page data
    var mkdocs_page_name = "Conductor Server";
    var mkdocs_page_input_path = "server.md";
    var mkdocs_page_url = null;
  </script>
  
  <script src="../js/jquery-2.1.1.min.js" defer></script>
  <script src="../js/modernizr-2.8.3.min.js" defer></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href=".." class="icon icon-home"> Conductor</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
	<ul class="current">
	  
          
            <li class="toctree-l1">
		
    <a class="" href="..">Introduction</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../architecture/">Architecture</a>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Getting Started</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../gettingstarted/basicconcepts/">Basic Concepts</a>
                </li>
                <li class="">
                    
    <a class="" href="../gettingstarted/client/">Using the Client</a>
                </li>
                <li class="">
                    
    <a class="" href="../gettingstarted/startworkflow/">Start a Workflow</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Configuration</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../configuration/taskdef/">Task Definition</a>
                </li>
                <li class="">
                    
    <a class="" href="../configuration/workflowdef/">Workflow Definition</a>
                </li>
                <li class="">
                    
    <a class="" href="../configuration/systask/">System Tasks</a>
                </li>
                <li class="">
                    
    <a class="" href="../configuration/eventhandlers/">Event Handlers</a>
                </li>
                <li class="">
                    
    <a class="" href="../configuration/taskdomains/">Task Domains</a>
                </li>
                <li class="">
                    
    <a class="" href="../configuration/isolationgroups/">Isolation Groups</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1 current">
		
    <a class="current" href="./">Conductor Server</a>
    <ul class="subnav">
            
    <li class="toctree-l2"><a href="#installing">Installing</a></li>
    
        <ul>
        
            <li><a class="toctree-l3" href="#requirements">Requirements</a></li>
        
        </ul>
    

    <li class="toctree-l2"><a href="#configuration">Configuration</a></li>
    
        <ul>
        
            <li><a class="toctree-l3" href="#configuration-parameters">Configuration Parameters</a></li>
        
        </ul>
    

    <li class="toctree-l2"><a href="#high-availability-configuration">High Availability Configuration</a></li>
    

    <li class="toctree-l2"><a href="#using-standalone-redis-elasticache">Using Standalone Redis / ElastiCache</a></li>
    

    <li class="toctree-l2"><a href="#setting-up-zookeeper-to-enable-distributed-locking-service">Setting up Zookeeper to enable Distributed Locking Service.</a></li>
    

    <li class="toctree-l2"><a href="#default-workflow-archiving-module-configuration">Default Workflow Archiving Module Configuration</a></li>
    
        <ul>
        
            <li><a class="toctree-l3" href="#1-enable-archiving-module">1. Enable Archiving Module</a></li>
        
            <li><a class="toctree-l3" href="#2-enable-workflow-status-listener">2. Enable Workflow Status Listener</a></li>
        
        </ul>
    

    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../apispec/">API Specification</a>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Conductor Metrics</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../metrics/server/">Server Metrics</a>
                </li>
                <li class="">
                    
    <a class="" href="../metrics/client/">Client Metrics</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../extend/">Extending Conductor</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../tasklifecycle/">Task Lifecycle</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../externalpayloadstorage/">External Payload Storage</a>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Developer Labs</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../labs/beginner/">Beginner</a>
                </li>
                <li class="">
                    
    <a class="" href="../labs/eventhandlers/">Events and Event Handlers</a>
                </li>
                <li class="">
                    
    <a class="" href="../labs/kitchensink/">Kitchensink</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../bestpractices/">Best Practices</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../faq/">FAQ</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../technicaldetails/">Technical Details</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../license/">License</a>
	    </li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="..">Conductor</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="..">Docs</a> &raquo;</li>
    
      
    
    <li>Conductor Server</li>
    <li class="wy-breadcrumbs-aside">
      
        <a href="https://github.com/Netflix/conductor/edit/dev/docs/docs/server.md"
          class="icon icon-github"> Edit on GitHub</a>
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h2 id="installing">Installing<a class="headerlink" href="#installing" title="Permanent link">&para;</a></h2>
<h3 id="requirements">Requirements<a class="headerlink" href="#requirements" title="Permanent link">&para;</a></h3>
<ol>
<li><strong>Database</strong>: <a href="https://github.com/Netflix/dynomite">Dynomite</a></li>
<li><strong>Indexing Backend</strong>: <a href="https://www.elastic.co">Elasticsearch 5.x</a></li>
<li><strong>Servlet Container</strong>: Tomcat, Jetty, or similar running JDK 1.8 or higher</li>
</ol>
<p>There are 3 ways in which you can install Conductor:</p>
<h4 id="1-build-from-source">1. Build from source<a class="headerlink" href="#1-build-from-source" title="Permanent link">&para;</a></h4>
<p>To build from source, checkout the code from github and build server module using <code>gradle build</code> command. If you do not have gradle installed, you can run the command <code>./gradlew build</code> from the project root. This produces <em>conductor-server-all-VERSION.jar</em> in the folder <em>./server/build/libs/</em></p>
<p>The jar can be executed using:</p>
<div class="codehilite"><pre><span></span>java -jar conductor-server-VERSION-all.jar
</pre></div>


<h4 id="2-download-pre-built-binaries-from-jcenter-or-maven-central">2. Download pre-built binaries from jcenter or maven central<a class="headerlink" href="#2-download-pre-built-binaries-from-jcenter-or-maven-central" title="Permanent link">&para;</a></h4>
<p>Use the following coordinates:</p>
<table>
<thead>
<tr>
<th>group</th>
<th>artifact</th>
<th>version</th>
</tr>
</thead>
<tbody>
<tr>
<td>com.netflix.conductor</td>
<td>conductor-server-all</td>
<td>2.7.+</td>
</tr>
</tbody>
</table>
<h4 id="3-use-the-pre-configured-docker-image">3. Use the pre-configured Docker image<a class="headerlink" href="#3-use-the-pre-configured-docker-image" title="Permanent link">&para;</a></h4>
<p>To build the docker images for the conductor server and ui run the commands:</p>
<div class="codehilite"><pre><span></span><span class="nb">cd</span> docker
docker-compose build
</pre></div>


<p>After the docker images are built, run the following command to start the containers:</p>
<div class="codehilite"><pre><span></span>docker-compose up
</pre></div>


<p>This will create a docker container network that consists of the following images: conductor:server, conductor:ui, <a href="https://hub.docker.com/_/elasticsearch/">elasticsearch:5.6.8</a>, and dynomite.</p>
<p>To view the UI, navigate to <a href="http://localhost:5000/">localhost:5000</a>, to view the Swagger docs, navigate to <a href="http://localhost:8080/">localhost:8080</a>.</p>
<h2 id="configuration">Configuration<a class="headerlink" href="#configuration" title="Permanent link">&para;</a></h2>
<p>Conductor server uses a property file based configuration.  The property file is passed to the Main class as a command line argument.</p>
<div class="codehilite"><pre><span></span>java -jar conductor-server-all-VERSION.jar <span class="o">[</span>PATH TO PROPERTY FILE<span class="o">]</span> <span class="o">[</span>log4j.properties file path<span class="o">]</span>
</pre></div>


<p>log4j.properties file path is optional and allows finer control over the logging (defaults to INFO level logging in the console).</p>
<h4 id="configuration-parameters">Configuration Parameters<a class="headerlink" href="#configuration-parameters" title="Permanent link">&para;</a></h4>
<div class="codehilite"><pre><span></span><span class="c"># Database persistence model.  Possible values are memory, redis, redis_cluster, redis_sentinel and dynomite.</span>
<span class="c"># If omitted, the persistence used is memory</span>
<span class="c">#</span>
<span class="c"># memory : The data is stored in memory and lost when the server dies.  Useful for testing or demo</span>
<span class="c"># redis : non-Dynomite based redis instance</span>
<span class="c"># redis_cluster: AWS Elasticache Redis (cluster mode enabled).See [http://docs.aws.amazon.com/AmazonElastiCache/latest/UserGuide/Clusters.Create.CON.RedisCluster.html]</span>
<span class="c"># redis_sentinel: Redis HA with Redis Sentinel. See [https://redis.io/topics/sentinel]</span>
<span class="c"># dynomite : Dynomite cluster.  Use this for HA configuration.</span>
<span class="na">db</span><span class="o">=</span><span class="s">dynomite</span>

<span class="c"># Dynomite Cluster details.</span>
<span class="c"># format is host:port:rack separated by semicolon</span>
<span class="c"># for AWS Elasticache Redis (cluster mode enabled) the format is configuration_endpoint:port:us-east-1e. The region in this case does not matter</span>
<span class="na">workflow.dynomite.cluster.hosts</span><span class="o">=</span><span class="s">host1:8102:us-east-1c;host2:8102:us-east-1d;host3:8102:us-east-1e</span>

<span class="c"># If you are running using dynomite, also add the following line to the property </span>
<span class="c"># to set the rack/availability zone of the conductor server to be same as dynomite cluster config</span>
<span class="na">EC2_AVAILABILTY_ZONE</span><span class="o">=</span><span class="s">us-east-1c</span>

<span class="c"># Dynomite cluster name</span>
<span class="na">workflow.dynomite.cluster.name</span><span class="o">=</span><span class="s">dyno_cluster_name</span>

<span class="c"># Maximum connections to redis/dynomite</span>
<span class="na">workflow.dynomite.connection.maxConnsPerHost</span><span class="o">=</span><span class="s">31</span>

<span class="c"># Namespace for the keys stored in Dynomite/Redis</span>
<span class="na">workflow.namespace.prefix</span><span class="o">=</span><span class="s">conductor</span>

<span class="c"># Namespace prefix for the dyno queues</span>
<span class="na">workflow.namespace.queue.prefix</span><span class="o">=</span><span class="s">conductor_queues</span>

<span class="c"># No. of threads allocated to dyno-queues (optional)</span>
<span class="na">queues.dynomite.threads</span><span class="o">=</span><span class="s">10</span>

<span class="c"># Non-quorum port used to connect to local redis.  Used by dyno-queues.</span>
<span class="c"># When using redis directly, set this to the same port as redis server.</span>
<span class="c"># For Dynomite, this is 22122 by default or the local redis-server port used by Dynomite.</span>
<span class="na">queues.dynomite.nonQuorum.port</span><span class="o">=</span><span class="s">22122</span>

<span class="c"># Transport address to elasticsearch</span>
<span class="c"># Specifying multiple node urls is not supported. specify one of the nodes&#39; url, or a load balancer.</span>
<span class="na">workflow.elasticsearch.url</span><span class="o">=</span><span class="s">localhost:9300</span>

<span class="c"># Name of the elasticsearch cluster</span>
<span class="na">workflow.elasticsearch.index.name</span><span class="o">=</span><span class="s">conductor</span>

<span class="c"># Additional modules (optional)</span>
<span class="na">conductor.additional.modules</span><span class="o">=</span><span class="s">class_extending_com.google.inject.AbstractModule</span>
</pre></div>


<h2 id="high-availability-configuration">High Availability Configuration<a class="headerlink" href="#high-availability-configuration" title="Permanent link">&para;</a></h2>
<p>Conductor servers are stateless and can be deployed on multiple servers to handle scale and availability needs.  The scalability of the server is achieved by scaling the <a href="https://github.com/Netflix/dynomite">Dynomite</a> cluster along with <a href="https://github.com/Netflix/dyno-queues">dyno-queues</a> which is used for queues.</p>
<p>Clients connects to the server via HTTP load balancer or using Discovery (on NetflixOSS stack).</p>
<h2 id="using-standalone-redis-elasticache">Using Standalone Redis / ElastiCache<a class="headerlink" href="#using-standalone-redis-elasticache" title="Permanent link">&para;</a></h2>
<p>Conductor server can be used with a standlone Redis or ElastiCache server.  To configure the server, change the config to use the following:</p>
<div class="codehilite"><pre><span></span><span class="na">db</span><span class="o">=</span><span class="s">redis</span>

<span class="c"># For AWS Elasticache Redis (cluster mode enabled) the format is configuration_endpoint:port:us-east-1e.</span>
<span class="c"># The region in this case does not matter</span>
<span class="na">workflow.dynomite.cluster.hosts</span><span class="o">=</span><span class="s">server_address:server_port:us-east-1e</span>
<span class="na">workflow.dynomite.connection.maxConnsPerHost</span><span class="o">=</span><span class="s">31</span>

<span class="na">queues.dynomite.nonQuorum.port</span><span class="o">=</span><span class="s">server_port</span>
</pre></div>


<h2 id="setting-up-zookeeper-to-enable-distributed-locking-service">Setting up Zookeeper to enable Distributed Locking Service.<a class="headerlink" href="#setting-up-zookeeper-to-enable-distributed-locking-service" title="Permanent link">&para;</a></h2>
<p>See <a href="/technicaldetails/#maintaining-workflow-consistency-with-distributed-locking-and-fencing-tokens">Technical Details</a> for more details about this.</p>
<p>Locking Service is disabled by default. Enable this by setting:</p>
<p><code>decider.locking.enabled: true</code></p>
<p>Setup Zookeeper cluster connection string:</p>
<p><code>zk.connection=1.2.3.4:2181,5.6.7.8:2181</code></p>
<p>Optionally, configure the default timeouts:</p>
<div class="codehilite"><pre><span></span>zk.sessionTimeoutMs
zk.connectionTimeoutMs
</pre></div>


<h2 id="default-workflow-archiving-module-configuration">Default Workflow Archiving Module Configuration<a class="headerlink" href="#default-workflow-archiving-module-configuration" title="Permanent link">&para;</a></h2>
<p>Conductor server does not perform automated workflow execution data cleaning by default. Archiving module (if enabled) 
removes all execution data from conductor persistence storage immediately upon workflow completion or termination, 
but keeps archived index data in elastic search. </p>
<p>To benefit form archiving module you have to do the following:</p>
<h3 id="1-enable-archiving-module">1. Enable Archiving Module<a class="headerlink" href="#1-enable-archiving-module" title="Permanent link">&para;</a></h3>
<p>Set property in server configuration.</p>
<div class="codehilite"><pre><span></span><span class="c"># Comma-separated additional conductor modules</span>
<span class="na">conductor.additional.modules</span><span class="o">=</span><span class="s">com.netflix.conductor.contribs.ArchivingWorkflowModule</span>
</pre></div>


<h3 id="2-enable-workflow-status-listener">2. Enable Workflow Status Listener<a class="headerlink" href="#2-enable-workflow-status-listener" title="Permanent link">&para;</a></h3>
<p>Archiving module is triggered only if workflow status listener is enabled on workflow definition level. To enable it 
you have to set <code>workflowStatusListenerEnabled</code> property to <code>true</code>. See sample workflow definition below:</p>
<div class="codehilite"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;e2e_approval_v4&quot;</span><span class="p">,</span>
  <span class="nt">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Approval Process&quot;</span><span class="p">,</span>
  <span class="nt">&quot;workflowStatusListenerEnabled&quot;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span> 
  <span class="nt">&quot;tasks&quot;</span><span class="p">:</span> <span class="p">[]</span>
<span class="p">}</span>
</pre></div>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../apispec/" class="btn btn-neutral float-right" title="API Specification">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../configuration/isolationgroups/" class="btn btn-neutral" title="Isolation Groups"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
          <a href="https://github.com/Netflix/conductor/" class="fa fa-github" style="float: left; color: #fcfcfc"> GitHub</a>
      
      
        <span><a href="../configuration/isolationgroups/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../apispec/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '..';</script>
    <script src="../js/theme.js" defer></script>
      <script src="../search/main.js" defer></script>

</body>
</html>
