import com.fasterxml.jackson.databind.JsonNode
import com.fasterxml.jackson.databind.ObjectMapper
import org.junit.jupiter.api.Test
import static org.junit.jupiter.api.Assertions.*

public class TestSerDerTask {

    @Test
    public void testSerDer() throws Exception {
        String serverJSON = "{\"retried\":true,\"outputData\":{\"sample_key\":\"sample_value\"},\"referenceTaskName\":\"sample_referenceTaskName\",\"workflowPriority\":123,\"isolationGroupId\":\"sample_isolationGroupId\",\"parentTaskId\":\"sample_parentTaskId\",\"executed\":true,\"subworkflowChanged\":true,\"taskType\":\"sample_taskType\",\"reasonForIncompletion\":\"sample_reasonForIncompletion\",\"responseTimeoutSeconds\":123,\"rateLimitFrequencyInSeconds\":123,\"iteration\":123,\"correlationId\":\"sample_correlationId\",\"startTime\":123,\"callbackFromWorker\":true,\"workflowType\":\"sample_workflowType\",\"workflowInstanceId\":\"sample_workflowInstanceId\",\"seq\":123,\"startDelayInSeconds\":123,\"inputData\":{\"sample_key\":\"sample_value\"},\"callbackAfterSeconds\":123,\"workerId\":\"sample_workerId\",\"scheduledTime\":123,\"externalInputPayloadStoragePath\":\"sample_externalInputPayloadStoragePath\",\"retryCount\":123,\"workflowTask\":{\"joinOn\":[\"sample_joinOn\"],\"description\":\"sample_description\",\"scriptExpression\":\"sample_scriptExpression\",\"cacheConfig\":{\"key\":\"sample_key\",\"ttlInSecond\":123},\"type\":\"sample_type\",\"inputParameters\":{\"sample_key\":\"sample_value\"},\"decisionCases\":{\"sample_key\":[{\"joinOn\":[\"sample_joinOn\"],\"description\":\"sample_description\",\"scriptExpression\":\"sample_scriptExpression\",\"cacheConfig\":{\"key\":\"sample_key\",\"ttlInSecond\":123},\"type\":\"sample_type\",\"inputParameters\":{\"sample_key\":\"sample_value\"},\"decisionCases\":{},\"loopOver\":[],\"caseExpression\":\"sample_caseExpression\",\"defaultExclusiveJoinTask\":[\"sample_defaultExclusiveJoinTask\"],\"taskDefinition\":{\"timeoutPolicy\":{\"values\":[\"RETRY\",\"TIME_OUT_WF\",\"ALERT_ONLY\"],\"constants\":{\"ALERT_ONLY\":\"(2)\",\"TIME_OUT_WF\":\"(1)\",\"RETRY\":\"(0)\"},\"sampleValue\":\"RETRY\"},\"inputKeys\":[\"sample_inputKeys\"],\"concurrentExecLimit\":123,\"isolationGroupId\":\"sample_isolationGroupId\",\"retryCount\":123,\"description\":\"sample_description\",\"inputTemplate\":{\"sample_key\":\"sample_value\"},\"ownerEmail\":\"sample_ownerEmail\",\"baseType\":\"sample_baseType\",\"totalTimeoutSeconds\":123,\"retryDelaySeconds\":123,\"backoffScaleFactor\":123,\"rateLimitPerFrequency\":123,\"retryLogic\":{\"values\":[\"FIXED\",\"EXPONENTIAL_BACKOFF\",\"LINEAR_BACKOFF\"],\"constants\":{\"EXPONENTIAL_BACKOFF\":\"(1)\",\"FIXED\":\"(0)\",\"LINEAR_BACKOFF\":\"(2)\"},\"sampleValue\":\"FIXED\"},\"responseTimeoutSeconds\":123,\"name\":\"sample_name\",\"timeoutSeconds\":123,\"rateLimitFrequencyInSeconds\":123,\"outputKeys\":[\"sample_outputKeys\"],\"executionNameSpace\":\"sample_executionNameSpace\",\"pollTimeoutSeconds\":123},\"caseValueParam\":\"sample_caseValueParam\",\"dynamicForkTasksInputParamName\":\"sample_dynamicForkTasksInputParamName\",\"expression\":\"sample_expression\",\"loopCondition\":\"sample_loopCondition\",\"asyncComplete\":true,\"sink\":\"sample_sink\",\"rateLimited\":true,\"retryCount\":123,\"subWorkflowParam\":{\"workflowDefinition\":\"sample_workflowDefinition\",\"idempotencyKey\":\"sample_idempotencyKey\",\"name\":\"sample_name\",\"taskToDomain\":{\"sample_key\":\"sample_value\"},\"priority\":\"sample_object_priority\",\"version\":123,\"idempotencyStrategy\":{\"values\":[\"FAIL\",\"RETURN_EXISTING\",\"FAIL_ON_RUNNING\"],\"constants\":{\"FAIL_ON_RUNNING\":\"(2)\",\"RETURN_EXISTING\":\"(1)\",\"FAIL\":\"(0)\"},\"sampleValue\":\"FAIL\"}},\"optional\":true,\"joinStatus\":\"sample_joinStatus\",\"evaluatorType\":\"sample_evaluatorType\",\"dynamicTaskNameParam\":\"sample_dynamicTaskNameParam\",\"name\":\"sample_name\",\"startDelay\":123,\"permissive\":true,\"taskReferenceName\":\"sample_taskReferenceName\",\"defaultCase\":[],\"forkTasks\":[[]],\"dynamicForkTasksParam\":\"sample_dynamicForkTasksParam\"}],\"loopOver\":[{\"joinOn\":[\"sample_joinOn\"],\"description\":\"sample_description\",\"scriptExpression\":\"sample_scriptExpression\",\"cacheConfig\":{\"key\":\"sample_key\",\"ttlInSecond\":123},\"type\":\"sample_type\",\"inputParameters\":{\"sample_key\":\"sample_value\"},\"decisionCases\":{},\"loopOver\":[],\"caseExpression\":\"sample_caseExpression\",\"defaultExclusiveJoinTask\":[\"sample_defaultExclusiveJoinTask\"],\"taskDefinition\":{\"timeoutPolicy\":{\"values\":[\"RETRY\",\"TIME_OUT_WF\",\"ALERT_ONLY\"],\"constants\":{\"ALERT_ONLY\":\"(2)\",\"TIME_OUT_WF\":\"(1)\",\"RETRY\":\"(0)\"},\"sampleValue\":\"RETRY\"},\"inputKeys\":[\"sample_inputKeys\"],\"concurrentExecLimit\":123,\"isolationGroupId\":\"sample_isolationGroupId\",\"retryCount\":123,\"description\":\"sample_description\",\"inputTemplate\":{\"sample_key\":\"sample_value\"},\"ownerEmail\":\"sample_ownerEmail\",\"baseType\":\"sample_baseType\",\"totalTimeoutSeconds\":123,\"retryDelaySeconds\":123,\"backoffScaleFactor\":123,\"rateLimitPerFrequency\":123,\"retryLogic\":{\"values\":[\"FIXED\",\"EXPONENTIAL_BACKOFF\",\"LINEAR_BACKOFF\"],\"constants\":{\"EXPONENTIAL_BACKOFF\":\"(1)\",\"FIXED\":\"(0)\",\"LINEAR_BACKOFF\":\"(2)\"},\"sampleValue\":\"FIXED\"},\"responseTimeoutSeconds\":123,\"name\":\"sample_name\",\"timeoutSeconds\":123,\"rateLimitFrequencyInSeconds\":123,\"outputKeys\":[\"sample_outputKeys\"],\"executionNameSpace\":\"sample_executionNameSpace\",\"pollTimeoutSeconds\":123},\"caseValueParam\":\"sample_caseValueParam\",\"dynamicForkTasksInputParamName\":\"sample_dynamicForkTasksInputParamName\",\"expression\":\"sample_expression\",\"loopCondition\":\"sample_loopCondition\",\"asyncComplete\":true,\"sink\":\"sample_sink\",\"rateLimited\":true,\"retryCount\":123,\"subWorkflowParam\":{\"workflowDefinition\":\"sample_workflowDefinition\",\"idempotencyKey\":\"sample_idempotencyKey\",\"name\":\"sample_name\",\"taskToDomain\":{\"sample_key\":\"sample_value\"},\"priority\":\"sample_object_priority\",\"version\":123,\"idempotencyStrategy\":{\"values\":[\"FAIL\",\"RETURN_EXISTING\",\"FAIL_ON_RUNNING\"],\"constants\":{\"FAIL_ON_RUNNING\":\"(2)\",\"RETURN_EXISTING\":\"(1)\",\"FAIL\":\"(0)\"},\"sampleValue\":\"FAIL\"}},\"optional\":true,\"joinStatus\":\"sample_joinStatus\",\"evaluatorType\":\"sample_evaluatorType\",\"dynamicTaskNameParam\":\"sample_dynamicTaskNameParam\",\"name\":\"sample_name\",\"startDelay\":123,\"permissive\":true,\"taskReferenceName\":\"sample_taskReferenceName\",\"defaultCase\":[],\"forkTasks\":[[]],\"dynamicForkTasksParam\":\"sample_dynamicForkTasksParam\"}],\"caseExpression\":\"sample_caseExpression\",\"defaultExclusiveJoinTask\":[\"sample_defaultExclusiveJoinTask\"],\"taskDefinition\":{\"timeoutPolicy\":{\"values\":[\"RETRY\",\"TIME_OUT_WF\",\"ALERT_ONLY\"],\"constants\":{\"ALERT_ONLY\":\"(2)\",\"TIME_OUT_WF\":\"(1)\",\"RETRY\":\"(0)\"},\"sampleValue\":\"RETRY\"},\"inputKeys\":[\"sample_inputKeys\"],\"concurrentExecLimit\":123,\"isolationGroupId\":\"sample_isolationGroupId\",\"retryCount\":123,\"description\":\"sample_description\",\"inputTemplate\":{\"sample_key\":\"sample_value\"},\"ownerEmail\":\"sample_ownerEmail\",\"baseType\":\"sample_baseType\",\"totalTimeoutSeconds\":123,\"retryDelaySeconds\":123,\"backoffScaleFactor\":123,\"rateLimitPerFrequency\":123,\"retryLogic\":{\"values\":[\"FIXED\",\"EXPONENTIAL_BACKOFF\",\"LINEAR_BACKOFF\"],\"constants\":{\"EXPONENTIAL_BACKOFF\":\"(1)\",\"FIXED\":\"(0)\",\"LINEAR_BACKOFF\":\"(2)\"},\"sampleValue\":\"FIXED\"},\"responseTimeoutSeconds\":123,\"name\":\"sample_name\",\"timeoutSeconds\":123,\"rateLimitFrequencyInSeconds\":123,\"outputKeys\":[\"sample_outputKeys\"],\"executionNameSpace\":\"sample_executionNameSpace\",\"pollTimeoutSeconds\":123},\"caseValueParam\":\"sample_caseValueParam\",\"dynamicForkTasksInputParamName\":\"sample_dynamicForkTasksInputParamName\",\"expression\":\"sample_expression\",\"loopCondition\":\"sample_loopCondition\",\"asyncComplete\":true,\"sink\":\"sample_sink\",\"rateLimited\":true,\"retryCount\":123,\"subWorkflowParam\":{\"workflowDefinition\":\"sample_workflowDefinition\",\"idempotencyKey\":\"sample_idempotencyKey\",\"name\":\"sample_name\",\"taskToDomain\":{\"sample_key\":\"sample_value\"},\"priority\":\"sample_object_priority\",\"version\":123,\"idempotencyStrategy\":{\"values\":[\"FAIL\",\"RETURN_EXISTING\",\"FAIL_ON_RUNNING\"],\"constants\":{\"FAIL_ON_RUNNING\":\"(2)\",\"RETURN_EXISTING\":\"(1)\",\"FAIL\":\"(0)\"},\"sampleValue\":\"FAIL\"}},\"optional\":true,\"joinStatus\":\"sample_joinStatus\",\"evaluatorType\":\"sample_evaluatorType\",\"dynamicTaskNameParam\":\"sample_dynamicTaskNameParam\",\"name\":\"sample_name\",\"startDelay\":123,\"permissive\":true,\"taskReferenceName\":\"sample_taskReferenceName\",\"defaultCase\":[{\"joinOn\":[\"sample_joinOn\"],\"description\":\"sample_description\",\"scriptExpression\":\"sample_scriptExpression\",\"cacheConfig\":{\"key\":\"sample_key\",\"ttlInSecond\":123},\"type\":\"sample_type\",\"inputParameters\":{\"sample_key\":\"sample_value\"},\"decisionCases\":{},\"loopOver\":[],\"caseExpression\":\"sample_caseExpression\",\"defaultExclusiveJoinTask\":[\"sample_defaultExclusiveJoinTask\"],\"taskDefinition\":{\"timeoutPolicy\":{\"values\":[\"RETRY\",\"TIME_OUT_WF\",\"ALERT_ONLY\"],\"constants\":{\"ALERT_ONLY\":\"(2)\",\"TIME_OUT_WF\":\"(1)\",\"RETRY\":\"(0)\"},\"sampleValue\":\"RETRY\"},\"inputKeys\":[\"sample_inputKeys\"],\"concurrentExecLimit\":123,\"isolationGroupId\":\"sample_isolationGroupId\",\"retryCount\":123,\"description\":\"sample_description\",\"inputTemplate\":{\"sample_key\":\"sample_value\"},\"ownerEmail\":\"sample_ownerEmail\",\"baseType\":\"sample_baseType\",\"totalTimeoutSeconds\":123,\"retryDelaySeconds\":123,\"backoffScaleFactor\":123,\"rateLimitPerFrequency\":123,\"retryLogic\":{\"values\":[\"FIXED\",\"EXPONENTIAL_BACKOFF\",\"LINEAR_BACKOFF\"],\"constants\":{\"EXPONENTIAL_BACKOFF\":\"(1)\",\"FIXED\":\"(0)\",\"LINEAR_BACKOFF\":\"(2)\"},\"sampleValue\":\"FIXED\"},\"responseTimeoutSeconds\":123,\"name\":\"sample_name\",\"timeoutSeconds\":123,\"rateLimitFrequencyInSeconds\":123,\"outputKeys\":[\"sample_outputKeys\"],\"executionNameSpace\":\"sample_executionNameSpace\",\"pollTimeoutSeconds\":123},\"caseValueParam\":\"sample_caseValueParam\",\"dynamicForkTasksInputParamName\":\"sample_dynamicForkTasksInputParamName\",\"expression\":\"sample_expression\",\"loopCondition\":\"sample_loopCondition\",\"asyncComplete\":true,\"sink\":\"sample_sink\",\"rateLimited\":true,\"retryCount\":123,\"subWorkflowParam\":{\"workflowDefinition\":\"sample_workflowDefinition\",\"idempotencyKey\":\"sample_idempotencyKey\",\"name\":\"sample_name\",\"taskToDomain\":{\"sample_key\":\"sample_value\"},\"priority\":\"sample_object_priority\",\"version\":123,\"idempotencyStrategy\":{\"values\":[\"FAIL\",\"RETURN_EXISTING\",\"FAIL_ON_RUNNING\"],\"constants\":{\"FAIL_ON_RUNNING\":\"(2)\",\"RETURN_EXISTING\":\"(1)\",\"FAIL\":\"(0)\"},\"sampleValue\":\"FAIL\"}},\"optional\":true,\"joinStatus\":\"sample_joinStatus\",\"evaluatorType\":\"sample_evaluatorType\",\"dynamicTaskNameParam\":\"sample_dynamicTaskNameParam\",\"name\":\"sample_name\",\"startDelay\":123,\"permissive\":true,\"taskReferenceName\":\"sample_taskReferenceName\",\"defaultCase\":[],\"forkTasks\":[[]],\"dynamicForkTasksParam\":\"sample_dynamicForkTasksParam\"}],\"forkTasks\":[[{\"joinOn\":[\"sample_joinOn\"],\"description\":\"sample_description\",\"scriptExpression\":\"sample_scriptExpression\",\"cacheConfig\":{\"key\":\"sample_key\",\"ttlInSecond\":123},\"type\":\"sample_type\",\"inputParameters\":{\"sample_key\":\"sample_value\"},\"decisionCases\":{},\"loopOver\":[],\"caseExpression\":\"sample_caseExpression\",\"defaultExclusiveJoinTask\":[\"sample_defaultExclusiveJoinTask\"],\"taskDefinition\":{\"timeoutPolicy\":{\"values\":[\"RETRY\",\"TIME_OUT_WF\",\"ALERT_ONLY\"],\"constants\":{\"ALERT_ONLY\":\"(2)\",\"TIME_OUT_WF\":\"(1)\",\"RETRY\":\"(0)\"},\"sampleValue\":\"RETRY\"},\"inputKeys\":[\"sample_inputKeys\"],\"concurrentExecLimit\":123,\"isolationGroupId\":\"sample_isolationGroupId\",\"retryCount\":123,\"description\":\"sample_description\",\"inputTemplate\":{\"sample_key\":\"sample_value\"},\"ownerEmail\":\"sample_ownerEmail\",\"baseType\":\"sample_baseType\",\"totalTimeoutSeconds\":123,\"retryDelaySeconds\":123,\"backoffScaleFactor\":123,\"rateLimitPerFrequency\":123,\"retryLogic\":{\"values\":[\"FIXED\",\"EXPONENTIAL_BACKOFF\",\"LINEAR_BACKOFF\"],\"constants\":{\"EXPONENTIAL_BACKOFF\":\"(1)\",\"FIXED\":\"(0)\",\"LINEAR_BACKOFF\":\"(2)\"},\"sampleValue\":\"FIXED\"},\"responseTimeoutSeconds\":123,\"name\":\"sample_name\",\"timeoutSeconds\":123,\"rateLimitFrequencyInSeconds\":123,\"outputKeys\":[\"sample_outputKeys\"],\"executionNameSpace\":\"sample_executionNameSpace\",\"pollTimeoutSeconds\":123},\"caseValueParam\":\"sample_caseValueParam\",\"dynamicForkTasksInputParamName\":\"sample_dynamicForkTasksInputParamName\",\"expression\":\"sample_expression\",\"loopCondition\":\"sample_loopCondition\",\"asyncComplete\":true,\"sink\":\"sample_sink\",\"rateLimited\":true,\"retryCount\":123,\"subWorkflowParam\":{\"workflowDefinition\":\"sample_workflowDefinition\",\"idempotencyKey\":\"sample_idempotencyKey\",\"name\":\"sample_name\",\"taskToDomain\":{\"sample_key\":\"sample_value\"},\"priority\":\"sample_object_priority\",\"version\":123,\"idempotencyStrategy\":{\"values\":[\"FAIL\",\"RETURN_EXISTING\",\"FAIL_ON_RUNNING\"],\"constants\":{\"FAIL_ON_RUNNING\":\"(2)\",\"RETURN_EXISTING\":\"(1)\",\"FAIL\":\"(0)\"},\"sampleValue\":\"FAIL\"}},\"optional\":true,\"joinStatus\":\"sample_joinStatus\",\"evaluatorType\":\"sample_evaluatorType\",\"dynamicTaskNameParam\":\"sample_dynamicTaskNameParam\",\"name\":\"sample_name\",\"startDelay\":123,\"permissive\":true,\"taskReferenceName\":\"sample_taskReferenceName\",\"defaultCase\":[],\"forkTasks\":[[]],\"dynamicForkTasksParam\":\"sample_dynamicForkTasksParam\"}]],\"dynamicForkTasksParam\":\"sample_dynamicForkTasksParam\"},\"retriedTaskId\":\"sample_retriedTaskId\",\"updateTime\":123,\"pollCount\":123,\"rateLimitPerFrequency\":123,\"subWorkflowId\":null,\"domain\":\"sample_domain\",\"taskDefName\":\"sample_taskDefName\",\"endTime\":123,\"executionNameSpace\":\"sample_executionNameSpace\",\"firstStartTime\":123,\"taskId\":\"sample_taskId\",\"status\":{\"values\":[\"IN_PROGRESS\",\"CANCELED\",\"FAILED\",\"FAILED_WITH_TERMINAL_ERROR\",\"COMPLETED\",\"COMPLETED_WITH_ERRORS\",\"SCHEDULED\",\"TIMED_OUT\",\"SKIPPED\"],\"constants\":{\"IN_PROGRESS\":\"(false, true, true)\",\"FAILED_WITH_TERMINAL_ERROR\":\"(true, false, false)\",\"COMPLETED\":\"(true, true, true)\",\"FAILED\":\"(true, false, true)\",\"TIMED_OUT\":\"(true, false, true)\",\"CANCELED\":\"(true, false, false)\",\"COMPLETED_WITH_ERRORS\":\"(true, true, true)\",\"SKIPPED\":\"(true, true, false)\",\"SCHEDULED\":\"(false, true, true)\"},\"sampleValue\":\"IN_PROGRESS\"},\"externalOutputPayloadStoragePath\":\"sample_externalOutputPayloadStoragePath\"}";

        ObjectMapper mapper = new ObjectMapper();

        // Unmarshal serverJSON to Task
        Task task = mapper.readValue(serverJSON, Task.class);

        // Assertions
        assertNotNull(task);
        assertTrue(task.isRetried());
        assertEquals("sample_taskType", task.getTaskType());
        assertEquals(Task.Status.IN_PROGRESS, task.getStatus());
        assertEquals("sample_referenceTaskName", task.getReferenceTaskName());
        assertEquals(123, task.getWorkflowPriority());
        assertEquals("sample_isolationGroupId", task.getIsolationGroupId());
        assertEquals("sample_parentTaskId", task.getParentTaskId());
        assertTrue(task.isExecuted());
        assertTrue(task.isSubworkflowChanged());
        assertEquals("sample_reasonForIncompletion", task.getReasonForIncompletion());
        assertEquals(123, task.getResponseTimeoutSeconds());
        assertEquals(123, task.getRateLimitFrequencyInSeconds());
        assertEquals(123, task.getIteration());
        assertEquals("sample_correlationId", task.getCorrelationId());
        assertEquals(123, task.getStartTime());
        assertTrue(task.isCallbackFromWorker());
        assertEquals("sample_workflowType", task.getWorkflowType());
        assertEquals("sample_workflowInstanceId", task.getWorkflowInstanceId());
        assertEquals(123, task.getSeq());
        assertEquals(123, task.getStartDelayInSeconds());
        assertEquals("sample_externalInputPayloadStoragePath", task.getExternalInputPayloadStoragePath());
        assertEquals(123, task.getRetryCount());
        assertEquals("sample_retriedTaskId", task.getRetriedTaskId());
        assertEquals(123, task.getUpdateTime());
        assertEquals(123, task.getPollCount());
        assertEquals(123, task.getRateLimitPerFrequency());
        assertNull(task.getSubWorkflowId());
        assertEquals("sample_domain", task.getDomain());
        assertEquals("sample_taskDefName", task.getTaskDefName());
        assertEquals(123, task.getEndTime());
        assertEquals("sample_executionNameSpace", task.getExecutionNameSpace());
        assertEquals(123, task.getFirstStartTime());
        assertEquals("sample_taskId", task.getTaskId());
        assertEquals("sample_externalOutputPayloadStoragePath", task.getExternalOutputPayloadStoragePath());

        // Additional assertions for maps, lists, and enums can be added here

        // Marshal the POJO to JSON again
        String serializedJSON = mapper.writeValueAsString(task);

        // Compare the JSONs
        JsonNode original = mapper.readTree(serverJSON);
        JsonNode serialized = mapper.readTree(serializedJSON);
        assertEquals(original, serialized);
    }
}